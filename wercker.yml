#wercker file
box: wercker/php

build:
  steps:
    - install-packages:
        packages: gawk
    - script:
        name: cache composer dependencies
        code: export COMPOSER_CACHE_DIR="$WERCKER_CACHE_DIR/composer" && mkdir -p $COMPOSER_CACHE_DIR
    - script:
        name: install dependencies
        code: composer install --no-interaction --prefer-source
    - script:
        name: PHPUnit Unit tests
        code: ./vendor/bin/phpunit tests/app
    - script:
        name: PHPUnit Hookah tests
        code: ./vendor/bin/paratest --colors -m 2 -p 4 --stop-on-failure --path= tests/Smoke
  after-steps:
     - hipchat-notify:
        token: $HIPCHAT_TOKEN
        room-id: 1267700
